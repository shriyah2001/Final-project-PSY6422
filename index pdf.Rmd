---
title: "PSY6422 Final project pdf"
output: pdf_document
always_allow_html: true
date: "2024-04-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### **An Exploration of Anime Trends: Themes in the Top Shows of 2023**
#### **Rationale**:
Japanese animation, also known as **Anime**, has gained immense popularity over the years. As I grew up watching anime, the topic of which Genre or Theme was more interesting always sparked a debate between me and my friends. And thus, for my final project for PSY6422, I will try to visualise common recurring themes in the top 1000 highly rated anime of the year 2023 on My Anime List. 

Action, adventure, comedy, drama, romance, fantasy, sci-fi, and many more genres are covered in anime. Better recommendation systems can be created by having a better understanding of which genres perform better. The reason why I choose themes over genre is because one anime could have multiple themes thus making our criteria more inclusive and relatively comprehensive.

The data will be presented as a *bar graph*, which was selected as the visualisation method for my project because it plots the rankings of various categories well. I've made an interactive version of my plot using *Plotly* because the original had multiple columns, which made it difficult to follow. The interactive feature of the graph allows the reader to simply hover over a column to see its description, such as the theme name and count.


#### **Question I aim to visualise:**
+ The top animes had which themes?

```{r echo=FALSE}
# Define the path to the image
image_path <- here::here("images/p1.png")

# Display the image
knitr::include_graphics(image_path)
```

*A still from [Tenki no ko](https://myanimelist.net/anime/38826/Tenki_no_Ko) by Makato Shinkai*

### **Source of the Dataset :**

The dataset was acquired from Md Kazi Sajiduddin on [kaggle](https://www.kaggle.com/datasets/dbdmobile/myanimelist-dataset).
It was created around July 2023. Jikan Application Programming Interface (4.0.0) was used to extract the anime dataset via the My Anime list. The original dataset retrived  anime-related data, including the original title, the english title, Demographics, Start season, Airing date,Format, Studios, Synopsis, Production house, The User ID and the scores given by the users. [MyAnimeList](https://myanimelist.net/). 

### **What is My Anime List?**
Frequently shortened as MAL, MyAnimeList is a volunteer-run website that provides social networking and social cataloging services for fans of anime and manga. Users of the website can score and arrange anime and manga using a system similar to a list. It offers a comprehensive database on anime and manga and makes it easier to find users with similar interests.

### **What will my project include?**
The data included 24,985 anime titles that were rated by users on My Anime List. The original dataset had a plethora of information including The original title, english title, Demographics, Start season, Airing date,Format, Studios, Synopsis, Production house, The User ID and the scores given by the users. 
For my project, I will examine the top 1000 anime titles in the dataset to identify recurring *themes*. Additionally, I will also visualise if the *Demographics* of the anime, taking a look at the intened auidence for the title as it may help us understand the relevance of themes better. Thus, I make sure only these columns are retrived from the rawdata.

### **Folders in my project:**
The /Data consists of the raw data acquired from kaggle, /figures consist of the Plots generated in the project and /images consist of the image used in the project.

```{r message=FALSE, warning=FALSE, include=FALSE}

# Loading the libraries required 
if (!require("here")) install.packages("here") # used to create a relative path for the data
if (!require("readr")) install.packages("readr") # used to read data from csv file
if (!require("tidyverse")) install.packages("tidyverse") # used for visualising
if (!require("dplyr")) install.packages("dplyr") # used to clean data
if (!require("ggplot2")) install.packages("ggplot2") # used to clean data
if (!require("ggthemes")) install.packages("ggthemes") # Used to import additional themes
if (!require("kableExtra")) install.packages("kableExtra") # used for creating tables in the document 
if (!require("plotly")) install.packages("plotly")  #  used to create interactive plots

library(here)
library(readr)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(ggplot2)
library(kableExtra)
library(plotly)

```
### Importing the data
```{r echo=TRUE, message=FALSE, warning=FALSE}

# Selecting specific columns
cols <- c('themes', 'demographics')
# Specifying the file path of the dataset
file_path <- here::here("Data/anime.csv")
data <- read_csv(file_path, col_select = cols,n_max = 1000) #n_max is set to 1000 in order to retrieve the top 1000 titles

# Renaming the columns
data <- rename(data,
            Themes= themes,
            Demographics= demographics
            )
```


```{r echo=FALSE}
# Data Wrangling:
# Cleaning the data by removing the special characters from the dataset with the lapply function
# First, to remove the Brackets
data <- data.frame(lapply(data, function(x) gsub("^\\[|\\]$", "", x)))

# Second, to remove quotation marks
data <- data.frame(lapply(data, function(x) gsub("'", "", x)))
```


```{r echo=FALSE}
# Making a dataset called df that divides Themes converted into a longer format
# Separating them into a longer form after spliting them after a comma
df <- separate_rows(data, Themes, sep = ",\\s*")
theme_counts <- df %>%   # I further assigned it to theme_counts to get a count check of the themes in the df dataset
    count(Themes) %>%
    filter(Themes != "") %>%  # to filter out rows with empty values
    arrange(desc(n)) %>%  # Arranging n into descending order
    rename(Count = n) # Renaming n as count
```

### **A table of the total theme count from top rated 1000 anime titles on My Anime List**:
```{r echo=TRUE}
kable(theme_counts, format = "markdown")
```

### **An interactive plot of the Theme count**

```{r echo=TRUE, fig.height=6, fig.width=9, message=FALSE, warning=FALSE}
# Assigning the rainbow theme to each unique theme in theme_count
theme_colors <- rainbow(length(unique(theme_counts$Themes)))
hover_text <-paste('Theme:', theme_counts$Themes, '<br>Count:' , theme_counts$Count) #setting the hover text 

# Creating the first graph with ggplot

fig1 <-
    ggplot(theme_counts, aes(x = reorder(Themes,-Count), y = Count, text = hover_text)) +
    geom_bar(stat = 'identity', fill = theme_colors) +
    scale_y_continuous(breaks = seq(0, 250, by = 50),expand =c(0,0)) + # To make the intervals on Y axis 50 and remove the gap between Y axis and 0
    ggtitle("Themes of the top rated anime of 2023") + # setting title
    labs(x = "Themes", y = "Count") + # defining labels
  
    theme_minimal() +
    theme(
      
        plot.background = element_rect(fill = 'black'),  # To create a black background
        panel.background = element_rect(fill = 'black'), # To create a black panel background
        panel.grid.major = element_line(color = 'transparent'),  # To make major gridlines transparent
        axis.line = element_line(color = '#FFFFFF'),  # axis lines colour set as White
        axis.text = element_text(color = '#EEB4B4'),  # axis text colour set as rosybrown2
        axis.title = element_text(color = 'skyblue'), # axis title colour set as skyblue
        plot.title = element_text(color = 'skyblue', size = 18, hjust = 0.5, face = 'italic'),
        axis.text.x = element_text(angle = 45, hjust = 1, size = 7)  # x-axis text angle was adjusted to make it more readable
        ) +
  
        guides(fill = FALSE)  # Removing the legend as the name of the column and count can be seen in the hover text

#assigning the plot to plotly fr an interactive graph
fig1 <- ggplotly(fig1, tooltip= 'text')
fig1

# Saving the figure in the figures folder
ggsave(here::here('Figures', 'Themes_graph.png'))
```
#### Bonus Graph: **Demographics**
> We can better understand which themes and tropes appeal to particular audiences by using demographic data.Therefore we will take a look at demographics as well. Typical demographics consist of:

+ Shounen: Targeted towards young boys
+ Shoujo: Targeted towards young girls 
+ Seinen: Targeted towards adult men 
+ Josei: Targeted towards adult women 
+ Kids: Targeted towards Younger auidence

```{r echo=FALSE}
# Assigning the count of demographics to dem_count
data <- separate_rows(data, Demographics, sep = ",\\s*") # To separate a row that has comma in it 
dem_counts <- data %>%
    count(Demographics) %>% 
    filter(Demographics != "") %>%  #To filter out rows with empty values
    arrange(desc(n)) %>% # Arranging the count in descending order
    rename(Count= n) # Renaming n as count 
```

```{r echo=TRUE}
kable(dem_counts, format = "markdown") 
```

### **A Graph that plots the demographics of the top 1000 anime of 2023**
```{r echo=TRUE, message=FALSE, warning=FALSE}
# Creating the second bar graph in ggplot

dem_colors <- rainbow(length(unique(dem_counts$Demographics))) # Setting up rainbow themes for the graph by assigning a colour to each unique value
hover_text <-paste('<br>Count:' , dem_counts$Count) #setting the hover text

fig2 <- 
    ggplot(dem_counts, aes(x =reorder(Demographics,Count), y = Count, fill = Demographics,text= hover_text)) +
    geom_bar(stat= 'identity')+
    labs(x= "Demographics", y= "Count", title= "Bar graph of demographics") + # defining labels
    coord_flip() + # To create a horizontal chart
    theme_minimal() +
    
  theme(
        plot.background = element_rect(fill = 'black'),  # To create black background
        panel.background = element_rect(fill = 'black'), # To create a black panel background
        panel.grid.major = element_line(color = 'transparent'),  # To make major gridlines transparent
        axis.line = element_line(color = '#FFFFFF'),  # axis lines colour set as White
        axis.text = element_text(color = '#EEB4B4'),  # axis text colour set as rosybrown2
        axis.title = element_text(color = 'skyblue'), # axis title colour set as skyblue
        plot.title = element_text(color = 'skyblue', size = 14),  # Plot title colour set to blue & size was adjusted
        
        ) +
  
    scale_fill_manual(values = dem_colors) +  # setting the colours in the plot
    guides(fill = FALSE) # removing the legend because the plot is interactive and the names and count can be seen when clicked on

#assigning the plot to plotly for an interactive graph
fig2 <- ggplotly(fig2, tooltip = 'text')
fig2
# Saving the figure in the figures folder
ggsave(here::here('Figures', 'Demographics.png'))
```

#### **Insights:**
2023 saw a lot of successful anime releases in a variety of genres. However, a clear trend became apparent: audiences were drawn to stories set in schools. Other themes that did well were Adult Cast, Historical, Psychological, Super Power, Mythology, Military, and Isekai. 
One prominent genre of anime was shounen, which catered to young boys. The predominance of themes like school,action and adventure, which are typically popular with this demographic, may be explained by this focus on a male audience.


Seinen, an anime series targeted at adult men, is among the top demographics, though, indicating a more complex picture. Seinen anime often explores mature themes like psychology and complex character development, which could explain why these themes were also highly rated in 2023. This implies that when deeper themes are presented in an engaging manner, viewers—even younger ones who appreciate Shounen—may be drawn to them.

#### **Closing remarks:**
With this module, I was able to learn a new skill at my own pace. I can say that over time, my proficiency with R Studio and Github has improved somewhat. I also took advantage of this opportunity to research different themes and packages that could help me with my project. I also looked into using *renv* to manage project environments and make sure the necessary packages are installed correctly across various devices. 


If I had more time to work on the project, I would have loved to plot all of the variables based on various criteria (for example, contrasting highly rated versus low rated anime titles) to have a comprehensive understanding of criteria that make an anime series highly rated. One of the limiations of my project can be that the  plots were based on the top 1000 titles, for a more comprehensive analysis, data of all the titles can be visualised by future projects.

#### **References :**
+ Anime Dataset 2023. (2023, July 28). Kaggle. https://www.kaggle.com/datasets/dbdmobile/myanimelist-dataset 
+ Grolemund, G., & Wickham, H. (2014). R for Data science. https://edtechbooks.org/r_data_science 
+ MyAnimeList.net: *anime and manga database and community.* (n.d.). MyAnimeList.net. https://myanimelist.net/ 
+ R CODER. (n.d). *R colors [Full List, Color Converter and Color Picker]* | R CHARTS. 